var $f55af31ee3f6336d2178b5b9b0d77a$exports = {};
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "lodash/isEqual");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "react");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "prop-types");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "./AnimateManager");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "./PureRender");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "./easing");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "./configUpdate");
$parcel$require("85f55af31ee3f6336d2178b5b9b0d77a", "./util");
var $f55af31ee3f6336d2178b5b9b0d77a$var$_class, $f55af31ee3f6336d2178b5b9b0d77a$var$_class2, $f55af31ee3f6336d2178b5b9b0d77a$var$_temp;

function $f55af31ee3f6336d2178b5b9b0d77a$var$_typeof(obj) {
  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    $f55af31ee3f6336d2178b5b9b0d77a$var$_typeof = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    $f55af31ee3f6336d2178b5b9b0d77a$var$_typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return $f55af31ee3f6336d2178b5b9b0d77a$var$_typeof(obj);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = $f55af31ee3f6336d2178b5b9b0d77a$var$_objectWithoutPropertiesLoose(source, excluded);
  var key, i;

  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }

  return target;
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_toConsumableArray(arr) {
  return $f55af31ee3f6336d2178b5b9b0d77a$var$_arrayWithoutHoles(arr) || $f55af31ee3f6336d2178b5b9b0d77a$var$_iterableToArray(arr) || $f55af31ee3f6336d2178b5b9b0d77a$var$_nonIterableSpread();
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance");
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_iterableToArray(iter) {
  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) {
    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {
      arr2[i] = arr[i];
    }

    return arr2;
  }
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    var ownKeys = Object.keys(source);

    if (typeof Object.getOwnPropertySymbols === 'function') {
      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {
        return Object.getOwnPropertyDescriptor(source, sym).enumerable;
      }));
    }

    ownKeys.forEach(function (key) {
      $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty(target, key, source[key]);
    });
  }

  return target;
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_createClass(Constructor, protoProps, staticProps) {
  if (protoProps) $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperties(Constructor.prototype, protoProps);
  if (staticProps) $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperties(Constructor, staticProps);
  return Constructor;
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_possibleConstructorReturn(self, call) {
  if (call && ($f55af31ee3f6336d2178b5b9b0d77a$var$_typeof(call) === "object" || typeof call === "function")) {
    return call;
  }

  return $f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized(self);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_getPrototypeOf(o) {
  $f55af31ee3f6336d2178b5b9b0d77a$var$_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return $f55af31ee3f6336d2178b5b9b0d77a$var$_getPrototypeOf(o);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  if (superClass) $f55af31ee3f6336d2178b5b9b0d77a$var$_setPrototypeOf(subClass, superClass);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_setPrototypeOf(o, p) {
  $f55af31ee3f6336d2178b5b9b0d77a$var$_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };

  return $f55af31ee3f6336d2178b5b9b0d77a$var$_setPrototypeOf(o, p);
}

function $f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}

var $f55af31ee3f6336d2178b5b9b0d77a$export$default = $f55af31ee3f6336d2178b5b9b0d77a$import$pureRender($f55af31ee3f6336d2178b5b9b0d77a$var$_class = ($f55af31ee3f6336d2178b5b9b0d77a$var$_temp = $f55af31ee3f6336d2178b5b9b0d77a$var$_class2 =
/*#__PURE__*/
function (_Component) {
  $f55af31ee3f6336d2178b5b9b0d77a$var$_inherits(Animate, _Component);

  function Animate(props, context) {
    var _this;

    $f55af31ee3f6336d2178b5b9b0d77a$var$_classCallCheck(this, Animate);
    _this = $f55af31ee3f6336d2178b5b9b0d77a$var$_possibleConstructorReturn(this, $f55af31ee3f6336d2178b5b9b0d77a$var$_getPrototypeOf(Animate).call(this, props, context));
    var _this$props = _this.props,
        isActive = _this$props.isActive,
        attributeName = _this$props.attributeName,
        from = _this$props.from,
        to = _this$props.to,
        steps = _this$props.steps,
        children = _this$props.children;
    _this.handleStyleChange = _this.handleStyleChange.bind($f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized($f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized(_this)));
    _this.changeStyle = _this.changeStyle.bind($f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized($f55af31ee3f6336d2178b5b9b0d77a$var$_assertThisInitialized(_this)));

    if (!isActive) {
      _this.state = {
        style: {}
      }; // if children is a function and animation is not active, set style to 'to'

      if (typeof children === 'function') {
        _this.state = {
          style: to
        };
      }

      return $f55af31ee3f6336d2178b5b9b0d77a$var$_possibleConstructorReturn(_this);
    }

    if (steps && steps.length) {
      _this.state = {
        style: steps[0].style
      };
    } else if (from) {
      if (typeof children === 'function') {
        _this.state = {
          style: from
        };
        return $f55af31ee3f6336d2178b5b9b0d77a$var$_possibleConstructorReturn(_this);
      }

      _this.state = {
        style: attributeName ? $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty({}, attributeName, from) : from
      };
    } else {
      _this.state = {
        style: {}
      };
    }

    return _this;
  }

  $f55af31ee3f6336d2178b5b9b0d77a$var$_createClass(Animate, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this$props2 = this.props,
          isActive = _this$props2.isActive,
          canBegin = _this$props2.canBegin;
      this.mounted = true;

      if (!isActive || !canBegin) {
        return;
      }

      this.runAnimation(this.props);
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var isActive = nextProps.isActive,
          canBegin = nextProps.canBegin,
          attributeName = nextProps.attributeName,
          shouldReAnimate = nextProps.shouldReAnimate;

      if (!canBegin) {
        return;
      }

      if (!isActive) {
        this.setState({
          style: attributeName ? $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty({}, attributeName, nextProps.to) : nextProps.to
        });
        return;
      }

      if ($f55af31ee3f6336d2178b5b9b0d77a$import$_isEqual(this.props.to, nextProps.to) && this.props.canBegin && this.props.isActive) {
        return;
      }

      var isTriggered = !this.props.canBegin || !this.props.isActive;

      if (this.manager) {
        this.manager.stop();
      }

      if (this.stopJSAnimation) {
        this.stopJSAnimation();
      }

      var from = isTriggered || shouldReAnimate ? nextProps.from : this.props.to;
      this.setState({
        style: attributeName ? $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty({}, attributeName, from) : from
      });
      this.runAnimation($f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread({}, nextProps, {
        from: from,
        begin: 0
      }));
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.mounted = false;

      if (this.unSubscribe) {
        this.unSubscribe();
      }

      if (this.manager) {
        this.manager.stop();
        this.manager = null;
      }

      if (this.stopJSAnimation) {
        this.stopJSAnimation();
      }
    }
  }, {
    key: "runJSAnimation",
    value: function runJSAnimation(props) {
      var _this2 = this;

      var from = props.from,
          to = props.to,
          duration = props.duration,
          easing = props.easing,
          begin = props.begin,
          onAnimationEnd = props.onAnimationEnd,
          onAnimationStart = props.onAnimationStart;
      var startAnimation = $f55af31ee3f6336d2178b5b9b0d77a$import$configUpdate(from, to, $f55af31ee3f6336d2178b5b9b0d77a$import$configEasing(easing), duration, this.changeStyle);

      var finalStartAnimation = function finalStartAnimation() {
        _this2.stopJSAnimation = startAnimation();
      };

      this.manager.start([onAnimationStart, begin, finalStartAnimation, duration, onAnimationEnd]);
    }
  }, {
    key: "runStepAnimation",
    value: function runStepAnimation(props) {
      var _this3 = this;

      var steps = props.steps,
          begin = props.begin,
          onAnimationStart = props.onAnimationStart;
      var _steps$ = steps[0],
          initialStyle = _steps$.style,
          _steps$$duration = _steps$.duration,
          initialTime = _steps$$duration === void 0 ? 0 : _steps$$duration;

      var addStyle = function addStyle(sequence, nextItem, index) {
        if (index === 0) {
          return sequence;
        }

        var duration = nextItem.duration,
            _nextItem$easing = nextItem.easing,
            easing = _nextItem$easing === void 0 ? 'ease' : _nextItem$easing,
            style = nextItem.style,
            nextProperties = nextItem.properties,
            onAnimationEnd = nextItem.onAnimationEnd;
        var preItem = index > 0 ? steps[index - 1] : nextItem;
        var properties = nextProperties || Object.keys(style);

        if (typeof easing === 'function' || easing === 'spring') {
          return $f55af31ee3f6336d2178b5b9b0d77a$var$_toConsumableArray(sequence).concat([_this3.runJSAnimation.bind(_this3, {
            from: preItem.style,
            to: style,
            duration: duration,
            easing: easing
          }), duration]);
        }

        var transition = $f55af31ee3f6336d2178b5b9b0d77a$import$getTransitionVal(properties, duration, easing);
        var newStyle = $f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread({}, preItem.style, style, {
          transition: transition
        });
        return $f55af31ee3f6336d2178b5b9b0d77a$var$_toConsumableArray(sequence).concat([newStyle, duration, onAnimationEnd]).filter($f55af31ee3f6336d2178b5b9b0d77a$import$identity);
      };

      return this.manager.start([onAnimationStart].concat($f55af31ee3f6336d2178b5b9b0d77a$var$_toConsumableArray(steps.reduce(addStyle, [initialStyle, Math.max(initialTime, begin)])), [props.onAnimationEnd]));
    }
  }, {
    key: "runAnimation",
    value: function runAnimation(props) {
      if (!this.manager) {
        this.manager = $f55af31ee3f6336d2178b5b9b0d77a$import$createAnimateManager();
      }

      var begin = props.begin,
          duration = props.duration,
          attributeName = props.attributeName,
          propsTo = props.to,
          easing = props.easing,
          onAnimationStart = props.onAnimationStart,
          onAnimationEnd = props.onAnimationEnd,
          steps = props.steps,
          children = props.children;
      var manager = this.manager;
      this.unSubscribe = manager.subscribe(this.handleStyleChange);

      if (typeof easing === 'function' || typeof children === 'function' || easing === 'spring') {
        this.runJSAnimation(props);
        return;
      }

      if (steps.length > 1) {
        this.runStepAnimation(props);
        return;
      }

      var to = attributeName ? $f55af31ee3f6336d2178b5b9b0d77a$var$_defineProperty({}, attributeName, propsTo) : propsTo;
      var transition = $f55af31ee3f6336d2178b5b9b0d77a$import$getTransitionVal(Object.keys(to), duration, easing);
      manager.start([onAnimationStart, begin, $f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread({}, to, {
        transition: transition
      }), duration, onAnimationEnd]);
    }
  }, {
    key: "handleStyleChange",
    value: function handleStyleChange(style) {
      this.changeStyle(style);
    }
  }, {
    key: "changeStyle",
    value: function changeStyle(style) {
      if (this.mounted) {
        this.setState({
          style: style
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props3 = this.props,
          children = _this$props3.children,
          begin = _this$props3.begin,
          duration = _this$props3.duration,
          attributeName = _this$props3.attributeName,
          easing = _this$props3.easing,
          isActive = _this$props3.isActive,
          steps = _this$props3.steps,
          from = _this$props3.from,
          to = _this$props3.to,
          canBegin = _this$props3.canBegin,
          onAnimationEnd = _this$props3.onAnimationEnd,
          shouldReAnimate = _this$props3.shouldReAnimate,
          onAnimationReStart = _this$props3.onAnimationReStart,
          others = $f55af31ee3f6336d2178b5b9b0d77a$var$_objectWithoutProperties(_this$props3, ["children", "begin", "duration", "attributeName", "easing", "isActive", "steps", "from", "to", "canBegin", "onAnimationEnd", "shouldReAnimate", "onAnimationReStart"]);
      var count = $f55af31ee3f6336d2178b5b9b0d77a$import$Children.count(children);
      var stateStyle = $f55af31ee3f6336d2178b5b9b0d77a$import$translateStyle(this.state.style);

      if (typeof children === 'function') {
        return children(stateStyle);
      }

      if (!isActive || count === 0) {
        return children;
      }

      var cloneContainer = function cloneContainer(container) {
        var _container$props = container.props,
            _container$props$styl = _container$props.style,
            style = _container$props$styl === void 0 ? {} : _container$props$styl,
            className = _container$props.className;
        var res = $f55af31ee3f6336d2178b5b9b0d77a$import$cloneElement(container, $f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread({}, others, {
          style: $f55af31ee3f6336d2178b5b9b0d77a$var$_objectSpread({}, style, stateStyle),
          className: className
        }));
        return res;
      };

      if (count === 1) {
        return cloneContainer($f55af31ee3f6336d2178b5b9b0d77a$import$Children.only(children));
      }

      return $f55af31ee3f6336d2178b5b9b0d77a$import$React.createElement("div", null, $f55af31ee3f6336d2178b5b9b0d77a$import$Children.map(children, function (child) {
        return cloneContainer(child);
      }));
    }
  }]);
  return Animate;
}($f55af31ee3f6336d2178b5b9b0d77a$import$Component), $f55af31ee3f6336d2178b5b9b0d77a$var$_class2.displayName = 'Animate', $f55af31ee3f6336d2178b5b9b0d77a$var$_class2.propTypes = {
  from: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOfType([$f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.object, $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.string]),
  to: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOfType([$f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.object, $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.string]),
  attributeName: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.string,
  // animation duration
  duration: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.number,
  begin: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.number,
  easing: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOfType([$f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.string, $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func]),
  steps: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.arrayOf($f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.shape({
    duration: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.number.isRequired,
    style: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.object.isRequired,
    easing: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOfType([$f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOf(['ease', 'ease-in', 'ease-out', 'ease-in-out', 'linear']), $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func]),
    // transition css properties(dash case), optional
    properties: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.arrayOf('string'),
    onAnimationEnd: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func
  })),
  children: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.oneOfType([$f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.node, $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func]),
  isActive: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.bool,
  canBegin: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.bool,
  onAnimationEnd: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func,
  // decide if it should reanimate with initial from style when props change
  shouldReAnimate: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.bool,
  onAnimationStart: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func,
  onAnimationReStart: $f55af31ee3f6336d2178b5b9b0d77a$import$PropTypes.func
}, $f55af31ee3f6336d2178b5b9b0d77a$var$_class2.defaultProps = {
  begin: 0,
  duration: 1000,
  from: '',
  to: '',
  attributeName: '',
  easing: 'ease',
  isActive: true,
  canBegin: true,
  steps: [],
  onAnimationEnd: function onAnimationEnd() {},
  onAnimationStart: function onAnimationStart() {}
}, $f55af31ee3f6336d2178b5b9b0d77a$var$_temp)) || $f55af31ee3f6336d2178b5b9b0d77a$var$_class;
$f55af31ee3f6336d2178b5b9b0d77a$exports.default = $f55af31ee3f6336d2178b5b9b0d77a$export$default;