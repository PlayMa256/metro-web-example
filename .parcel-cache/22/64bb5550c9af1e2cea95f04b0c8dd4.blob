var $e5d81b2ec83dfb644268b20cc69d28f$exports = {};
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "lodash/get");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "lodash/omit");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "lodash/isFunction");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "lodash/isNaN");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "react");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "prop-types");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "react-smooth");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "classnames");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../container/Surface");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../container/Layer");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../shape/Rectangle");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/ReactUtils");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../component/Tooltip");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../shape/Polygon");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/PureRender");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/ChartUtils");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/Constants");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/DOMUtils");
$parcel$require("7e5d81b2ec83dfb644268b20cc69d28f", "../util/DataUtils");
var $e5d81b2ec83dfb644268b20cc69d28f$var$_class, $e5d81b2ec83dfb644268b20cc69d28f$var$_class2, $e5d81b2ec83dfb644268b20cc69d28f$var$_temp;

function $e5d81b2ec83dfb644268b20cc69d28f$var$_typeof(obj) {
  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
    $e5d81b2ec83dfb644268b20cc69d28f$var$_typeof = function _typeof(obj) {
      return typeof obj;
    };
  } else {
    $e5d81b2ec83dfb644268b20cc69d28f$var$_typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };
  }

  return $e5d81b2ec83dfb644268b20cc69d28f$var$_typeof(obj);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_extends() {
  $e5d81b2ec83dfb644268b20cc69d28f$var$_extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return $e5d81b2ec83dfb644268b20cc69d28f$var$_extends.apply(this, arguments);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = $e5d81b2ec83dfb644268b20cc69d28f$var$_objectWithoutPropertiesLoose(source, excluded);
  var key, i;

  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }

  return target;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_createClass(Constructor, protoProps, staticProps) {
  if (protoProps) $e5d81b2ec83dfb644268b20cc69d28f$var$_defineProperties(Constructor.prototype, protoProps);
  if (staticProps) $e5d81b2ec83dfb644268b20cc69d28f$var$_defineProperties(Constructor, staticProps);
  return Constructor;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_possibleConstructorReturn(self, call) {
  if (call && ($e5d81b2ec83dfb644268b20cc69d28f$var$_typeof(call) === "object" || typeof call === "function")) {
    return call;
  }

  return $e5d81b2ec83dfb644268b20cc69d28f$var$_assertThisInitialized(self);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_getPrototypeOf(o) {
  $e5d81b2ec83dfb644268b20cc69d28f$var$_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return $e5d81b2ec83dfb644268b20cc69d28f$var$_getPrototypeOf(o);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  if (superClass) $e5d81b2ec83dfb644268b20cc69d28f$var$_setPrototypeOf(subClass, superClass);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_setPrototypeOf(o, p) {
  $e5d81b2ec83dfb644268b20cc69d28f$var$_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };

  return $e5d81b2ec83dfb644268b20cc69d28f$var$_setPrototypeOf(o, p);
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }

  return keys;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      $e5d81b2ec83dfb644268b20cc69d28f$var$ownKeys(source, true).forEach(function (key) {
        $e5d81b2ec83dfb644268b20cc69d28f$var$_defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      $e5d81b2ec83dfb644268b20cc69d28f$var$ownKeys(source).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function $e5d81b2ec83dfb644268b20cc69d28f$var$_defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}
/* eslint-disable jsx-a11y/no-static-element-interactions */

/**
 * @fileOverview TreemapChart
 */


var $e5d81b2ec83dfb644268b20cc69d28f$var$computeNode = function computeNode(_ref) {
  var depth = _ref.depth,
      node = _ref.node,
      index = _ref.index,
      valueKey = _ref.valueKey;
  var children = node.children;
  var childDepth = depth + 1;
  var computedChildren = children && children.length ? children.map(function (child, i) {
    return computeNode({
      depth: childDepth,
      node: child,
      index: i,
      valueKey: valueKey
    });
  }) : null;
  var value;

  if (children && children.length) {
    value = computedChildren.reduce(function (result, child) {
      return result + child.value;
    }, 0);
  } else {
    value = $e5d81b2ec83dfb644268b20cc69d28f$import$_isNaN(node[valueKey]) || node[valueKey] <= 0 ? 0 : node[valueKey];
  }

  return $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, node, {
    children: computedChildren,
    value: value,
    depth: depth,
    index: index
  });
};

var $e5d81b2ec83dfb644268b20cc69d28f$var$filterRect = function filterRect(node) {
  return {
    x: node.x,
    y: node.y,
    width: node.width,
    height: node.height
  };
}; // Compute the area for each child based on value & scale.


var $e5d81b2ec83dfb644268b20cc69d28f$var$getAreaOfChildren = function getAreaOfChildren(children, areaValueRatio) {
  var ratio = areaValueRatio < 0 ? 0 : areaValueRatio;
  return children.map(function (child) {
    var area = child.value * ratio;
    return $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, child, {
      area: $e5d81b2ec83dfb644268b20cc69d28f$import$_isNaN(area) || area <= 0 ? 0 : area
    });
  });
}; // Computes the score for the specified row, as the worst aspect ratio.


var $e5d81b2ec83dfb644268b20cc69d28f$var$getWorstScore = function getWorstScore(row, parentSize, aspectRatio) {
  var parentArea = parentSize * parentSize;
  var rowArea = row.area * row.area;

  var _row$reduce = row.reduce(function (result, child) {
    return {
      min: Math.min(result.min, child.area),
      max: Math.max(result.max, child.area)
    };
  }, {
    min: Infinity,
    max: 0
  }),
      min = _row$reduce.min,
      max = _row$reduce.max;

  return rowArea ? Math.max(parentArea * max * aspectRatio / rowArea, rowArea / (parentArea * min * aspectRatio)) : Infinity;
};

var $e5d81b2ec83dfb644268b20cc69d28f$var$horizontalPosition = function horizontalPosition(row, parentSize, parentRect, isFlush) {
  var rowHeight = parentSize ? Math.round(row.area / parentSize) : 0;

  if (isFlush || rowHeight > parentRect.height) {
    rowHeight = parentRect.height;
  }

  var curX = parentRect.x;
  var child;

  for (var i = 0, len = row.length; i < len; i++) {
    child = row[i];
    child.x = curX;
    child.y = parentRect.y;
    child.height = rowHeight;
    child.width = Math.min(rowHeight ? Math.round(child.area / rowHeight) : 0, parentRect.x + parentRect.width - curX);
    curX += child.width;
  } // what's z


  child.z = true; // add the remain x to the last one of row

  child.width += parentRect.x + parentRect.width - curX;
  return $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, parentRect, {
    y: parentRect.y + rowHeight,
    height: parentRect.height - rowHeight
  });
};

var $e5d81b2ec83dfb644268b20cc69d28f$var$verticalPosition = function verticalPosition(row, parentSize, parentRect, isFlush) {
  var rowWidth = parentSize ? Math.round(row.area / parentSize) : 0;

  if (isFlush || rowWidth > parentRect.width) {
    rowWidth = parentRect.width;
  }

  var curY = parentRect.y;
  var child;

  for (var i = 0, len = row.length; i < len; i++) {
    child = row[i];
    child.x = parentRect.x;
    child.y = curY;
    child.width = rowWidth;
    child.height = Math.min(rowWidth ? Math.round(child.area / rowWidth) : 0, parentRect.y + parentRect.height - curY);
    curY += child.height;
  }

  child.z = false;
  child.height += parentRect.y + parentRect.height - curY;
  return $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, parentRect, {
    x: parentRect.x + rowWidth,
    width: parentRect.width - rowWidth
  });
};

var $e5d81b2ec83dfb644268b20cc69d28f$var$position = function position(row, parentSize, parentRect, isFlush) {
  if (parentSize === parentRect.width) {
    return $e5d81b2ec83dfb644268b20cc69d28f$var$horizontalPosition(row, parentSize, parentRect, isFlush);
  }

  return $e5d81b2ec83dfb644268b20cc69d28f$var$verticalPosition(row, parentSize, parentRect, isFlush);
}; // Recursively arranges the specified node's children into squarified rows.


var $e5d81b2ec83dfb644268b20cc69d28f$var$squarify = function squarify(node, aspectRatio) {
  var children = node.children;

  if (children && children.length) {
    var rect = $e5d81b2ec83dfb644268b20cc69d28f$var$filterRect(node);
    var row = [];
    var best = Infinity; // the best row score so far

    var child, score; // the current row score

    var size = Math.min(rect.width, rect.height); // initial orientation

    var scaleChildren = $e5d81b2ec83dfb644268b20cc69d28f$var$getAreaOfChildren(children, rect.width * rect.height / node.value);
    var tempChildren = scaleChildren.slice();
    row.area = 0;

    while (tempChildren.length > 0) {
      // row first
      // eslint-disable-next-line prefer-destructuring
      row.push(child = tempChildren[0]);
      row.area += child.area;
      score = $e5d81b2ec83dfb644268b20cc69d28f$var$getWorstScore(row, size, aspectRatio);

      if (score <= best) {
        // continue with this orientation
        tempChildren.shift();
        best = score;
      } else {
        // abort, and try a different orientation
        row.area -= row.pop().area;
        rect = $e5d81b2ec83dfb644268b20cc69d28f$var$position(row, size, rect, false);
        size = Math.min(rect.width, rect.height);
        row.length = row.area = 0;
        best = Infinity;
      }
    }

    if (row.length) {
      rect = $e5d81b2ec83dfb644268b20cc69d28f$var$position(row, size, rect, true);
      row.length = row.area = 0;
    }

    return $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, node, {
      children: scaleChildren.map(function (c) {
        return squarify(c, aspectRatio);
      })
    });
  }

  return node;
};

var $e5d81b2ec83dfb644268b20cc69d28f$export$default = $e5d81b2ec83dfb644268b20cc69d28f$import$pureRender($e5d81b2ec83dfb644268b20cc69d28f$var$_class = ($e5d81b2ec83dfb644268b20cc69d28f$var$_temp = $e5d81b2ec83dfb644268b20cc69d28f$var$_class2 =
/*#__PURE__*/
function (_Component) {
  $e5d81b2ec83dfb644268b20cc69d28f$var$_inherits(Treemap, _Component);

  function Treemap() {
    var _getPrototypeOf2;

    var _this;

    $e5d81b2ec83dfb644268b20cc69d28f$var$_classCallCheck(this, Treemap);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = $e5d81b2ec83dfb644268b20cc69d28f$var$_possibleConstructorReturn(this, (_getPrototypeOf2 = $e5d81b2ec83dfb644268b20cc69d28f$var$_getPrototypeOf(Treemap)).call.apply(_getPrototypeOf2, [this].concat(args)));
    _this.state = _this.constructor.createDefaultState();

    _this.handleAnimationEnd = function () {
      var onAnimationEnd = _this.props.onAnimationEnd;

      _this.setState({
        isAnimationFinished: true
      });

      if ($e5d81b2ec83dfb644268b20cc69d28f$import$_isFunction(onAnimationEnd)) {
        onAnimationEnd();
      }
    };

    _this.handleAnimationStart = function () {
      var onAnimationStart = _this.props.onAnimationStart;

      _this.setState({
        isAnimationFinished: false
      });

      if ($e5d81b2ec83dfb644268b20cc69d28f$import$_isFunction(onAnimationStart)) {
        onAnimationStart();
      }
    };

    return _this;
  }

  $e5d81b2ec83dfb644268b20cc69d28f$var$_createClass(Treemap, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this$props = this.props,
          type = _this$props.type,
          width = _this$props.width,
          height = _this$props.height,
          data = _this$props.data,
          dataKey = _this$props.dataKey,
          aspectRatio = _this$props.aspectRatio;

      var _this$computeRoot = this.computeRoot({
        type: type,
        width: width,
        height: height,
        data: data,
        dataKey: dataKey,
        aspectRatio: aspectRatio
      }),
          formatRoot = _this$computeRoot.formatRoot,
          currentRoot = _this$computeRoot.currentRoot,
          nestIndex = _this$computeRoot.nestIndex;

      this.setState({
        formatRoot: formatRoot,
        currentRoot: currentRoot,
        nestIndex: nestIndex
      });
    }
  }, {
    key: "computeRoot",
    value: function computeRoot(_ref2) {
      var type = _ref2.type,
          width = _ref2.width,
          height = _ref2.height,
          data = _ref2.data,
          dataKey = _ref2.dataKey,
          aspectRatio = _ref2.aspectRatio;
      var root = $e5d81b2ec83dfb644268b20cc69d28f$var$computeNode({
        depth: 0,
        node: {
          children: data,
          x: 0,
          y: 0,
          width: width,
          height: height
        },
        index: 0,
        valueKey: dataKey
      });
      var formatRoot = $e5d81b2ec83dfb644268b20cc69d28f$var$squarify(root, aspectRatio);
      var nestIndex = this.state.nestIndex;

      if (type === 'nest') {
        nestIndex.push(root);
      }

      return {
        formatRoot: formatRoot,
        currentRoot: root,
        nestIndex: nestIndex
      };
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var type = nextProps.type,
          width = nextProps.width,
          height = nextProps.height,
          data = nextProps.data,
          dataKey = nextProps.dataKey,
          aspectRatio = nextProps.aspectRatio;

      if (data !== this.props.data || type !== this.props.type || width !== this.props.width || height !== this.props.height || dataKey !== this.props.dataKey || aspectRatio !== this.props.aspectRatio) {
        var nextRoot = this.computeRoot({
          type: type,
          width: width,
          height: height,
          data: data,
          dataKey: dataKey,
          aspectRatio: aspectRatio
        });
        this.setState($e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, this.constructor.createDefaultState(), {}, nextRoot, {
          nestIndex: [nextRoot.currentRoot]
        }));
      }
    }
    /**
     * Returns default, reset state for the treemap chart.
     * @return {Object} Whole new state
     */

  }, {
    key: "handleMouseEnter",
    value: function handleMouseEnter(node, e) {
      var _this$props2 = this.props,
          onMouseEnter = _this$props2.onMouseEnter,
          children = _this$props2.children;
      var tooltipItem = $e5d81b2ec83dfb644268b20cc69d28f$import$findChildByType(children, $e5d81b2ec83dfb644268b20cc69d28f$import$Tooltip);

      if (tooltipItem) {
        this.setState({
          isTooltipActive: true,
          activeNode: node
        }, function () {
          if (onMouseEnter) {
            onMouseEnter(node, e);
          }
        });
      } else if (onMouseEnter) {
        onMouseEnter(node, e);
      }
    }
  }, {
    key: "handleMouseLeave",
    value: function handleMouseLeave(node, e) {
      var _this$props3 = this.props,
          onMouseLeave = _this$props3.onMouseLeave,
          children = _this$props3.children;
      var tooltipItem = $e5d81b2ec83dfb644268b20cc69d28f$import$findChildByType(children, $e5d81b2ec83dfb644268b20cc69d28f$import$Tooltip);

      if (tooltipItem) {
        this.setState({
          isTooltipActive: false,
          activeNode: null
        }, function () {
          if (onMouseLeave) {
            onMouseLeave(node, e);
          }
        });
      } else if (onMouseLeave) {
        onMouseLeave(node, e);
      }
    }
  }, {
    key: "handleClick",
    value: function handleClick(node) {
      var _this$props4 = this.props,
          onClick = _this$props4.onClick,
          type = _this$props4.type;

      if (type === 'nest' && node.children) {
        var _this$props5 = this.props,
            width = _this$props5.width,
            height = _this$props5.height,
            dataKey = _this$props5.dataKey,
            aspectRatio = _this$props5.aspectRatio;
        var root = $e5d81b2ec83dfb644268b20cc69d28f$var$computeNode({
          depth: 0,
          node: $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, node, {
            x: 0,
            y: 0,
            width: width,
            height: height
          }),
          index: 0,
          valueKey: dataKey
        });
        var formatRoot = $e5d81b2ec83dfb644268b20cc69d28f$var$squarify(root, aspectRatio);
        var nestIndex = this.state.nestIndex;
        nestIndex.push(node);
        this.setState({
          formatRoot: formatRoot,
          currentRoot: root,
          nestIndex: nestIndex
        });
      }

      if (onClick) {
        onClick(node);
      }
    }
  }, {
    key: "handleNestIndex",
    value: function handleNestIndex(node, i) {
      var nestIndex = this.state.nestIndex;
      var _this$props6 = this.props,
          width = _this$props6.width,
          height = _this$props6.height,
          dataKey = _this$props6.dataKey,
          aspectRatio = _this$props6.aspectRatio;
      var root = $e5d81b2ec83dfb644268b20cc69d28f$var$computeNode({
        depth: 0,
        node: $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, node, {
          x: 0,
          y: 0,
          width: width,
          height: height
        }),
        index: 0,
        valueKey: dataKey
      });
      var formatRoot = $e5d81b2ec83dfb644268b20cc69d28f$var$squarify(root, aspectRatio);
      nestIndex = nestIndex.slice(0, i + 1);
      this.setState({
        formatRoot: formatRoot,
        currentRoot: node,
        nestIndex: nestIndex
      });
    }
  }, {
    key: "renderItem",
    value: function renderItem(content, nodeProps, isLeaf) {
      var _this2 = this;

      var _this$props7 = this.props,
          isAnimationActive = _this$props7.isAnimationActive,
          animationBegin = _this$props7.animationBegin,
          animationDuration = _this$props7.animationDuration,
          animationEasing = _this$props7.animationEasing,
          isUpdateAnimationActive = _this$props7.isUpdateAnimationActive,
          type = _this$props7.type,
          animationId = _this$props7.animationId,
          colorPanel = _this$props7.colorPanel;
      var isAnimationFinished = this.state.isAnimationFinished;
      var width = nodeProps.width,
          height = nodeProps.height,
          x = nodeProps.x,
          y = nodeProps.y,
          depth = nodeProps.depth;
      var translateX = parseInt((Math.random() * 2 - 1) * width, 10);
      var event = {};

      if (isLeaf || type === 'nest') {
        event = {
          onMouseEnter: this.handleMouseEnter.bind(this, nodeProps),
          onMouseLeave: this.handleMouseLeave.bind(this, nodeProps),
          onClick: this.handleClick.bind(this, nodeProps)
        };
      }

      if (!isAnimationActive) {
        return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Layer, event, this.constructor.renderContentItem(content, $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, nodeProps, {
          isAnimationActive: false,
          isUpdateAnimationActive: false,
          width: width,
          height: height,
          x: x,
          y: y
        }), type, colorPanel));
      }

      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Smooth, {
        begin: animationBegin,
        duration: animationDuration,
        isActive: isAnimationActive,
        easing: animationEasing,
        key: "treemap-".concat(animationId),
        from: {
          x: x,
          y: y,
          width: width,
          height: height
        },
        to: {
          x: x,
          y: y,
          width: width,
          height: height
        },
        onAnimationStart: this.handleAnimationStart,
        onAnimationEnd: this.handleAnimationEnd
      }, function (_ref3) {
        var currX = _ref3.x,
            currY = _ref3.y,
            currWidth = _ref3.width,
            currHeight = _ref3.height;
        return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Smooth, {
          from: "translate(".concat(translateX, "px, ").concat(translateX, "px)"),
          to: "translate(0, 0)",
          attributeName: "transform",
          begin: animationBegin,
          easing: animationEasing,
          isActive: isAnimationActive,
          duration: animationDuration
        }, $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Layer, event, function () {
          // when animation Duration , only render depth=1 nodes
          if (depth > 2 && !isAnimationFinished) {
            return null;
          }

          return _this2.constructor.renderContentItem(content, $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, nodeProps, {
            isAnimationActive: isAnimationActive,
            isUpdateAnimationActive: !isUpdateAnimationActive,
            width: currWidth,
            height: currHeight,
            x: currX,
            y: currY
          }), type, colorPanel);
        }()));
      });
    }
  }, {
    key: "renderNode",
    value: function renderNode(root, node, i) {
      var _this3 = this;

      var _this$props8 = this.props,
          content = _this$props8.content,
          type = _this$props8.type;
      var nodeProps = $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, $e5d81b2ec83dfb644268b20cc69d28f$import$getPresentationAttributes(this.props), {}, node, {
        root: root
      });
      var isLeaf = !node.children || !node.children.length;
      var currentRoot = this.state.currentRoot;
      var isCurrentRootChild = (currentRoot.children || []).filter(function (item) {
        return item.depth === node.depth && item.name === node.name;
      });

      if (!isCurrentRootChild.length && root.depth && type === 'nest') {
        return null;
      }

      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Layer, {
        key: "recharts-treemap-node-".concat(i),
        className: "recharts-treemap-depth-".concat(node.depth)
      }, this.renderItem(content, nodeProps, isLeaf), node.children && node.children.length ? node.children.map(function (child, index) {
        return _this3.renderNode(node, child, index);
      }) : null);
    }
  }, {
    key: "renderAllNodes",
    value: function renderAllNodes() {
      var formatRoot = this.state.formatRoot;

      if (!formatRoot) {
        return null;
      }

      return this.renderNode(formatRoot, formatRoot, 0);
    }
  }, {
    key: "renderTooltip",
    value: function renderTooltip() {
      var _this$props9 = this.props,
          children = _this$props9.children,
          nameKey = _this$props9.nameKey;
      var tooltipItem = $e5d81b2ec83dfb644268b20cc69d28f$import$findChildByType(children, $e5d81b2ec83dfb644268b20cc69d28f$import$Tooltip);

      if (!tooltipItem) {
        return null;
      }

      var _this$props10 = this.props,
          width = _this$props10.width,
          height = _this$props10.height,
          dataKey = _this$props10.dataKey;
      var _this$state = this.state,
          isTooltipActive = _this$state.isTooltipActive,
          activeNode = _this$state.activeNode;
      var viewBox = {
        x: 0,
        y: 0,
        width: width,
        height: height
      };
      var coordinate = activeNode ? {
        x: activeNode.x + activeNode.width / 2,
        y: activeNode.y + activeNode.height / 2
      } : null;
      var payload = isTooltipActive && activeNode ? [{
        payload: activeNode,
        name: $e5d81b2ec83dfb644268b20cc69d28f$import$getValueByDataKey(activeNode, nameKey, ''),
        value: $e5d81b2ec83dfb644268b20cc69d28f$import$getValueByDataKey(activeNode, dataKey)
      }] : [];
      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.cloneElement(tooltipItem, {
        viewBox: viewBox,
        active: isTooltipActive,
        coordinate: coordinate,
        label: '',
        payload: payload
      });
    } // render nest treemap

  }, {
    key: "renderNestIndex",
    value: function renderNestIndex() {
      var _this4 = this;

      var _this$props11 = this.props,
          nameKey = _this$props11.nameKey,
          nestIndexContent = _this$props11.nestIndexContent;
      var nestIndex = this.state.nestIndex;
      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement("div", {
        className: "recharts-treemap-nest-index-wrapper",
        style: {
          marginTop: '8px',
          textAlign: 'center'
        }
      }, nestIndex.map(function (item, i) {
        var name = $e5d81b2ec83dfb644268b20cc69d28f$import$_get(item, nameKey, 'root');
        var content = null;

        if ($e5d81b2ec83dfb644268b20cc69d28f$import$React.isValidElement(nestIndexContent)) {
          content = $e5d81b2ec83dfb644268b20cc69d28f$import$React.cloneElement(nestIndexContent, item, i);
        }

        if ($e5d81b2ec83dfb644268b20cc69d28f$import$_isFunction(nestIndexContent)) {
          content = nestIndexContent(item, i);
        } else {
          content = name;
        }

        return (// eslint-disable-next-line jsx-a11y/click-events-have-key-events
          $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement("div", {
            onClick: _this4.handleNestIndex.bind(_this4, item, i),
            key: "nest-index-".concat($e5d81b2ec83dfb644268b20cc69d28f$import$uniqueId()),
            className: "recharts-treemap-nest-index-box",
            style: {
              cursor: 'pointer',
              display: 'inline-block',
              padding: '0 7px',
              background: '#000',
              color: '#fff',
              marginRight: '3px'
            }
          }, content)
        );
      }));
    }
  }, {
    key: "render",
    value: function render() {
      if (!$e5d81b2ec83dfb644268b20cc69d28f$import$validateWidthHeight(this)) {
        return null;
      }

      var _this$props12 = this.props,
          width = _this$props12.width,
          height = _this$props12.height,
          className = _this$props12.className,
          style = _this$props12.style,
          children = _this$props12.children,
          type = _this$props12.type,
          others = $e5d81b2ec83dfb644268b20cc69d28f$var$_objectWithoutProperties(_this$props12, ["width", "height", "className", "style", "children", "type"]);
      var attrs = $e5d81b2ec83dfb644268b20cc69d28f$import$getPresentationAttributes(others);
      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement("div", {
        className: $e5d81b2ec83dfb644268b20cc69d28f$import$classNames('recharts-wrapper', className),
        style: $e5d81b2ec83dfb644268b20cc69d28f$var$_objectSpread({}, style, {
          position: 'relative',
          cursor: 'default',
          width: width,
          height: height
        })
      }, $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Surface, $e5d81b2ec83dfb644268b20cc69d28f$var$_extends({}, attrs, {
        width: width,
        height: type === 'nest' ? height - 30 : height
      }), this.renderAllNodes(), $e5d81b2ec83dfb644268b20cc69d28f$import$filterSvgElements(children)), this.renderTooltip(), type === 'nest' && this.renderNestIndex());
    }
  }], [{
    key: "createDefaultState",
    value: function createDefaultState() {
      return {
        isTooltipActive: false,
        isAnimationFinished: false,
        activeNode: null,
        currentRoot: null,
        formatRoot: null,
        nestIndex: []
      };
    }
  }, {
    key: "renderContentItem",
    value: function renderContentItem(content, nodeProps, type, colorPanel) {
      if ($e5d81b2ec83dfb644268b20cc69d28f$import$React.isValidElement(content)) {
        return $e5d81b2ec83dfb644268b20cc69d28f$import$React.cloneElement(content, nodeProps);
      }

      if ($e5d81b2ec83dfb644268b20cc69d28f$import$_isFunction(content)) {
        return content(nodeProps);
      } // optimize default shape


      var x = nodeProps.x,
          y = nodeProps.y,
          width = nodeProps.width,
          height = nodeProps.height,
          index = nodeProps.index;
      var arrow = null;

      if (width > 10 && height > 10 && nodeProps.children && type === 'nest') {
        arrow = $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Polygon, {
          points: [{
            x: x + 2,
            y: y + height / 2
          }, {
            x: x + 6,
            y: y + height / 2 + 3
          }, {
            x: x + 2,
            y: y + height / 2 + 6
          }]
        });
      }

      var text = null;
      var nameSize = $e5d81b2ec83dfb644268b20cc69d28f$import$getStringSize(nodeProps.name);

      if (width > 20 && height > 20 && nameSize.width < width && nameSize.height < height) {
        text = $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement("text", {
          x: x + 8,
          y: y + height / 2 + 7,
          fontSize: 14
        }, nodeProps.name);
      }

      var colors = colorPanel || $e5d81b2ec83dfb644268b20cc69d28f$import$COLOR_PANEL;
      return $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement("g", null, $e5d81b2ec83dfb644268b20cc69d28f$import$React.createElement($e5d81b2ec83dfb644268b20cc69d28f$import$Rectangle, $e5d81b2ec83dfb644268b20cc69d28f$var$_extends({
        fill: nodeProps.depth < 2 ? colors[index % colors.length] : 'rgba(255,255,255,0)',
        stroke: "#fff"
      }, $e5d81b2ec83dfb644268b20cc69d28f$import$_omit(nodeProps, 'children'))), arrow, text);
    }
  }]);
  return Treemap;
}($e5d81b2ec83dfb644268b20cc69d28f$import$Component), $e5d81b2ec83dfb644268b20cc69d28f$var$_class2.displayName = 'Treemap', $e5d81b2ec83dfb644268b20cc69d28f$var$_class2.propTypes = {
  width: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number,
  height: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number,
  data: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.array,
  style: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.object,
  aspectRatio: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number,
  content: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOfType([$e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.element, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func]),
  fill: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string,
  stroke: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string,
  className: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string,
  nameKey: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOfType([$e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func]),
  dataKey: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOfType([$e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func]),
  children: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOfType([$e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.arrayOf($e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.node), $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.node]),
  // optional values flat/nest, flat show whole treemap, nest only show depth=1 node
  type: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOf(['flat', 'nest']),
  colorPanel: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.array,
  // customize nest index content
  nestIndexContent: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOfType([$e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.element, $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func]),
  onAnimationStart: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func,
  onAnimationEnd: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func,
  onMouseEnter: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func,
  onMouseLeave: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func,
  onClick: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.func,
  isAnimationActive: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.bool,
  isUpdateAnimationActive: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.bool,
  animationBegin: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number,
  animationDuration: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.number,
  animationEasing: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.oneOf(['ease', 'ease-in', 'ease-out', 'ease-in-out', 'linear']),
  animationId: $e5d81b2ec83dfb644268b20cc69d28f$import$PropTypes.string
}, $e5d81b2ec83dfb644268b20cc69d28f$var$_class2.defaultProps = {
  dataKey: 'value',
  aspectRatio: 0.5 * (1 + Math.sqrt(5)),
  isAnimationActive: !$e5d81b2ec83dfb644268b20cc69d28f$import$isSsr(),
  isUpdateAnimationActive: !$e5d81b2ec83dfb644268b20cc69d28f$import$isSsr(),
  animationBegin: 0,
  animationDuration: 1500,
  animationEasing: 'linear',
  type: 'flat'
}, $e5d81b2ec83dfb644268b20cc69d28f$var$_temp)) || $e5d81b2ec83dfb644268b20cc69d28f$var$_class;
$e5d81b2ec83dfb644268b20cc69d28f$exports.default = $e5d81b2ec83dfb644268b20cc69d28f$export$default;